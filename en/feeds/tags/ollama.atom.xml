<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Annotations by Pablo Caro - ollama</title><link href="https://pablocaro.es/en/" rel="alternate"></link><link href="https://pablocaro.es/feeds/tags/ollama.atom.xml" rel="self"></link><id>https://pablocaro.es/en/</id><updated>2024-10-01T07:12:00+02:00</updated><subtitle>Annotations</subtitle><entry><title>Geospatial Data Conflation with DuckDB and Embeddings</title><link href="https://pablocaro.es/en/conflacion-datos-geoespaciales-duckdb" rel="alternate"></link><published>2024-10-01T07:12:00+02:00</published><updated>2024-10-01T07:12:00+02:00</updated><author><name>Pablo Caro</name></author><id>tag:pablocaro.es,2024-10-01:/en/conflacion-datos-geoespaciales-duckdb</id><summary type="html">&lt;p class="first last"&gt;Advanced techniques to integrate geospatial data sources using DuckDB, H3, Ollama, and embedding models&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Drew Breunig presents a fascinating case study of &lt;strong&gt;geospatial data conflation&lt;/strong&gt;: the process of identifying and merging similar records from different sources.&lt;/p&gt;
&lt;div class="section" id="the-challenge-integrating-restaurant-data"&gt;
&lt;h2&gt;The Challenge: Integrating Restaurant Data&lt;/h2&gt;
&lt;p&gt;The goal was to connect two data sources:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;Restaurant inspections&lt;/strong&gt; from Alameda County&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Place data&lt;/strong&gt; from Overture Maps Foundation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Two datasets with similar information but structured differently.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="modern-stack-tools"&gt;
&lt;h2&gt;Modern Stack Tools&lt;/h2&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;&lt;strong&gt;DuckDB as the main engine&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;strong&gt;Staging and querying&lt;/strong&gt; large volumes of data&lt;/li&gt;
&lt;li&gt;Native support for geospatial formats&lt;/li&gt;
&lt;li&gt;Exceptional performance for exploratory analysis&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;&lt;strong&gt;H3 for spatial grouping&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Group nearby places using H3 hexagons&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h3_cell_to_lat_lng&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;h3_latlng_to_cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lng&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h3_9&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;places&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;&lt;strong&gt;Ollama for local embeddings&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;ML framework running locally&lt;/li&gt;
&lt;li&gt;Generation of contextual embeddings&lt;/li&gt;
&lt;li&gt;No dependence on external APIs&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/div&gt;
&lt;div class="section" id="three-matching-approaches"&gt;
&lt;h2&gt;Three Matching Approaches&lt;/h2&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;&lt;strong&gt;1. Exact Name Matching&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;strong&gt;Result&lt;/strong&gt;: ~31% matches&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Limitations&lt;/strong&gt;: Chain names, unit numbers in addresses&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;&lt;strong&gt;2. String Similarity (Jaro-Winkler)&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Comparison combining name and address&lt;/span&gt;
&lt;span class="k"&gt;WHERE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaro_winkler_similarity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;levenshtein&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;address1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;address2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;Result&lt;/strong&gt;: ~68% matches&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Disadvantage&lt;/strong&gt;: Complex SQL with many conditional rules&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;3. Embedding-Based Matching&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Generate contextual description&lt;/span&gt;
&lt;span class="n"&gt;description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; at &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; in &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;city&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;embedding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ollama&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;embeddings&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;description&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;Result&lt;/strong&gt;: ~71% matches&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advantages&lt;/strong&gt;: Simpler pipeline, greater flexibility&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Disadvantage&lt;/strong&gt;: Longer processing time&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="key-insights"&gt;
&lt;h2&gt;Key Insights&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;strong&gt;There is no silver bullet&lt;/strong&gt; - each method has specific strengths&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Local tools are powerful&lt;/strong&gt; - DuckDB + Ollama allow sophisticated analysis without cloud&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Embeddings are promising&lt;/strong&gt; - especially for cases with complex context&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Conflation requires iteration&lt;/strong&gt; - combining multiple techniques improves results&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="the-future-of-data-integration"&gt;
&lt;h2&gt;The Future of Data Integration&lt;/h2&gt;
&lt;p&gt;This work shows how modern tools democratize techniques that previously required complex infrastructure. The combination of:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;Analytical databases&lt;/strong&gt; (DuckDB)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Spatial indices&lt;/strong&gt; (H3)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Local ML&lt;/strong&gt; (Ollama)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;...opens new possibilities for intelligent data integration.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Original article&lt;/em&gt;: &lt;a class="reference external" href="https://www.dbreunig.com/2024/09/27/conflating-overture-points-of-interests-with-duckdb-ollama-and-more.html"&gt;Conflating Overture Places Using DuckDB, Ollama, Embeddings, and More&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</content><category term="Programming"></category><category term="duckdb"></category><category term="geospatial"></category><category term="embeddings"></category><category term="ollama"></category><category term="h3"></category></entry></feed>