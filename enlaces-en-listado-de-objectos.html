
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://pablocaro.es/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://pablocaro.es/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://pablocaro.es/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://pablocaro.es/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://pablocaro.es/theme/font-awesome/css/solid.css">


  <link rel="shortcut icon" href="/theme/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/theme/img/favicon.ico" type="image/x-icon">

  <!-- Chrome, Firefox OS and Opera -->
  <meta name="theme-color" content="#333333">
  <!-- Windows Phone -->
  <meta name="msapplication-navbutton-color" content="#333333">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Microsoft EDGE -->
  <meta name="msapplication-TileColor" content="#333333">

  <link href="https://pablocaro.es/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Anotaciones por Pablo Caro Atom">

  <link href="https://pablocaro.es/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Anotaciones por Pablo Caro RSS">

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-60035125-1', 'auto');
  ga('send', 'pageview');
</script>






 

<meta name="author" content="Pablo Caro" />
<meta name="description" content="En mis proyectos suelo usar enlaces a elementos relacionados en el change_list del admin. Ficheros utils.py admin.py utils.py Tengo esto en utils.py from django.contrib import admin from django.contrib.contenttypes.models import ContentType from django.core import urlresolvers from django.utils.datastructures import SortedDict from …" />
<meta name="keywords" content="django, python">


  <meta property="og:site_name" content="Anotaciones por Pablo Caro"/>
  <meta property="og:title" content="Django: enlaces en listado de objectos"/>
  <meta property="og:description" content="En mis proyectos suelo usar enlaces a elementos relacionados en el change_list del admin. Ficheros utils.py admin.py utils.py Tengo esto en utils.py from django.contrib import admin from django.contrib.contenttypes.models import ContentType from django.core import urlresolvers from django.utils.datastructures import SortedDict from …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://pablocaro.es/enlaces-en-listado-de-objectos"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2014-05-21 10:42:00+02:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="https://pablocaro.es/author/pablo-caro.html">
  <meta property="article:section" content="Programación"/>
  <meta property="article:tag" content="django"/>
  <meta property="article:tag" content="python"/>
  <meta property="og:image" content="/theme/img/profile.png">

  <title>Anotaciones por Pablo Caro &ndash; Django: enlaces en listado de objectos</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="https://pablocaro.es/">
      <img src="/theme/img/profile.png" alt="Anotaciones" title="Anotaciones">
    </a>

    <h1>
      <a href="https://pablocaro.es/">Anotaciones</a>
    </h1>

    <p>Anotaciones</p>


    <nav>
      <ul class="list">



          <li>
            <a target="_self" href="http://getpelican.com/" >Pelican</a>
          </li>
          <li>
            <a target="_self" href="http://python.org/" >Python.org</a>
          </li>
          <li>
            <a target="_self" href="http://jinja.pocoo.org/" >Jinja2</a>
          </li>
          <li>
            <a target="_self" href="#" >You can modify those links in your config file</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-Twitter"
           href="http://twitter.com/pcaro"
           target="_blank">
          <i class="fa-brands fa-Twitter"></i>
        </a>
      </li>
      <li>
        <a class="sc-Github"
           href="http://github.com/pcaro"
           target="_blank">
          <i class="fa-brands fa-Github"></i>
        </a>
      </li>
      <li>
        <a class="sc-Linkedin"
           href="https://www.linkedin.com/in/pcarorevuelta"
           target="_blank">
          <i class="fa-brands fa-Linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-Facebook"
           href="https://www.facebook.com/pablo.carorevuelta"
           target="_blank">
          <i class="fa-brands fa-Facebook"></i>
        </a>
      </li>
      <li>
        <a class="sc-Email"
           href="mailto:correo@pablocaro.es"
           target="_blank">
          <i class="fa-brands fa-Email"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>

<nav>
  <a href="https://pablocaro.es/">Home</a>

  <a href="/archives.html">Archivo</a>
  <a href="/categories.html">Categorías</a>
  <a href="/tags.html">Etiquetas</a>

  <a href="https://pablocaro.es/feeds/all.atom.xml">Atom</a>

  <a href="https://pablocaro.es/feeds/all.rss.xml">RSS</a>
</nav>

<article class="single">
  <header>
      
    <h1 id="enlaces-en-listado-de-objectos">Django: enlaces en listado de objectos</h1>
    <p>
      Posted on Wed 21 May 2014 in <a href="https://pablocaro.es/category/programacion.html">Programación</a>

    </p>
  </header>


  <div>
    <p>En mis proyectos suelo usar enlaces a elementos relacionados en el change_list del admin.</p>
<div class="contents topic" id="ficheros">
<p class="topic-title">Ficheros</p>
<ul class="simple">
<li><a class="reference internal" href="#utils-py" id="toc-entry-1">utils.py</a></li>
<li><a class="reference internal" href="#admin-py" id="toc-entry-2">admin.py</a></li>
</ul>
</div>
<div class="section" id="utils-py">
<h2><a class="toc-backref" href="#toc-entry-1">utils.py</a></h2>
<p>Tengo esto en <code>utils.py</code></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.contrib.contenttypes.models</span> <span class="kn">import</span> <span class="n">ContentType</span>
<span class="kn">from</span> <span class="nn">django.core</span> <span class="kn">import</span> <span class="n">urlresolvers</span>
<span class="kn">from</span> <span class="nn">django.utils.datastructures</span> <span class="kn">import</span> <span class="n">SortedDict</span>
<span class="kn">from</span> <span class="nn">django.utils.functional</span> <span class="kn">import</span> <span class="n">memoize</span>

<span class="k">def</span> <span class="nf">get_change_url</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Utility method</span>
<span class="sd">        def server_link(self, obj):</span>
<span class="sd">             return self.get_change_url(obj.server)</span>
<span class="sd">        server_link.short_description = _(&#39;server&#39;)</span>
<span class="sd">        server_link.allow_tags = True</span>
<span class="sd">        server_link.admin_order_field = &#39;server__name&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">content_type</span> <span class="o">=</span> <span class="n">get_content_type</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>

    <span class="n">change_url</span> <span class="o">=</span> <span class="n">urlresolvers</span><span class="o">.</span><span class="n">reverse</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_change&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">app_name</span><span class="p">,</span> <span class="n">content_type</span><span class="o">.</span><span class="n">app_label</span><span class="p">,</span> <span class="n">content_type</span><span class="o">.</span><span class="n">model</span><span class="p">),</span>
        <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;a href=&quot;</span><span class="si">%s</span><span class="s1">&quot;&gt;</span><span class="si">%s</span><span class="s1">&lt;/a&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">change_url</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_content_type</span><span class="p">(</span><span class="n">klass</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">klass</span><span class="p">)</span>
<span class="n">get_content_type</span> <span class="o">=</span> <span class="n">memoize</span><span class="p">(</span><span class="n">_get_content_type</span><span class="p">,</span> <span class="n">SortedDict</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>Hago uso de memoize para aumentar la eficiencia. Creo que es el punto junto entre simplicidad
en el código con facilidad de uso. He tenido también decoradores para repetir menos en el admin.py
pero cuando otros veían el código no lo entendían a la primera.</p>
</div>
<div class="section" id="admin-py">
<h2><a class="toc-backref" href="#toc-entry-2">admin.py</a></h2>
<p>Un ejemplo de uso: en <code>admin.py</code> (suponiendo que el modelo Link tiene un FK llamado product):</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">get_change_url</span>

<span class="k">class</span> <span class="nc">LinkAdmin</span><span class="p">(</span><span class="n">AdminImageMixin</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;is_visible&#39;</span><span class="p">,</span> <span class="s1">&#39;product_link&#39;</span><span class="p">,</span> <span class="s1">&#39;updated_at&#39;</span><span class="p">]</span>
    <span class="n">search_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">]</span>

    <span class="k">def</span> <span class="nf">product_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">get_change_url</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">product</span><span class="p">)</span>
    <span class="n">product_link</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="s1">&#39;Product&#39;</span>
    <span class="n">product_link</span><span class="o">.</span><span class="n">allow_tags</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">product_link</span><span class="o">.</span><span class="n">admin_order_field</span> <span class="o">=</span> <span class="s1">&#39;product__name&#39;</span>
</pre></div>
</div>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://pablocaro.es/tag/django.html">django</a>
      <a href="https://pablocaro.es/tag/python.html">python</a>
    </p>
  </div>



  <div class="neighbors">
    <a class="btn float-left" href="https://pablocaro.es/settings-vars-processor" title="Settings vars processor">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="https://pablocaro.es/funcion-generica-para-usar-como-upload_to" title="Función genérica para usar como upload_to">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://pablocaro.es/instalar-insync-en-opensuse">Instalar InSync en Opensuse</a></li>
      <li><a href="https://pablocaro.es/decorador-vista-ajax">Decorador vista ajax</a></li>
      <li><a href="https://pablocaro.es/funcion-generica-para-usar-como-upload_to">Función genérica para usar como upload_to</a></li>
      <li><a href="https://pablocaro.es/settings-vars-processor">Settings vars processor</a></li>
      <li><a href="https://pablocaro.es/pandas-styler-presentacion-dataframes">Pandas Styler: Mejora la presentación de tus DataFrames</a></li>
    </ul>
  </div>



<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'anotaciones';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

<footer>
<p>
  &copy; 2025  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/3.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/3.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Anotaciones por Pablo Caro ",
  "url" : "https://pablocaro.es",
  "image": "/theme/img/profile.png",
  "description": ""
}
</script>
</body>
</html>